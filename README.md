# Разработка упрощённого синтаксического анализатора SQL-запросов на PL/pgSQL или внешнем языке (например, Python) (с возможностью валидации, трансформации и логирования структуры запроса) 
## Цель работы: разработать упрощённый синтаксический анализатор SQL-запросов, способный парсить, валидировать, трансформировать и логировать структуру запроса (тип операции, участвующие таблицы, условия WHERE, используемые функции), реализованный либо на PL/pgSQL, либо во внешнем языке (например, Python) с последующей интеграцией в экосистему PostgreSQL.
## В рамках работы необходимо изучить основы лексического и синтаксического анализа, ограничения обработки строк в PL/pgSQL, а также возможности внешних библиотек (например, sqlparse или pglast в Python). 

### Требуется реализовать:
- модуль парсинга, который принимает текст SQL-запроса и возвращает его структурное представление (AST-подобный формат): тип команды (SELECT, INSERT, UPDATE, DELETE), список таблиц и схем, наличие потенциально опасных конструкций (DROP, TRUNCATE, EXECUTE), условия фильтрации, агрегаты, подзапросы (в упрощённом виде); 
- механизм валидации (например, запрет DDL-запросов, проверка на использование чёрного списка функций);
- возможность трансформации запроса (например, добавление WHERE tenant_id = current_setting('app.tenant') для мультиарендности);
- логирование структуры запроса в служебную таблицу query_parse_log или во внешнюю систему;
- (опционально) интеграцию с PostgreSQL через внешний скрипт, вызываемый из приложения или через COPY ... PROGRAM / фоновый воркер.

### Особое внимание уделить безопасности (предотвращение инъекций при обработке), ограниченной, но достаточной глубине анализа и производительности.

### Ожидаемые результаты:
- Рабочий парсер SQL (на Python с использованием sqlparse или аналога, либо упрощённая реализация на PL/pgSQL).
- Функции/скрипты для валидации, трансформации и логирования запросов.
- Примеры применения: фильтрация опасных запросов, автоматическая инъекция условий безопасности, аудит структуры DML-операций.
